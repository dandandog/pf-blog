<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:fn="http://java.sun.com/jsp/jstl/functions"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                template="/WEB-INF/template.xhtml"
                xmlns:framework="http://java.sun.com/jsf/composite/components">
    <ui:define name="title">#{msg['blog']['roleManage']}</ui:define>
    <ui:define name="viewname">
        <li>#{msg['blog']['auth']}</li>
        <li>/</li>
        <li>#{msg['blog']['roleManage']}</li>
    </ui:define>
    <ui:define name="content">
        <div class="card">
            <h:form id="contentform" prependId="false">
                <framework:dataTable id="role" formDialogId="role" lazy="true"
                                     headText="#{msg['blog']['roleManagement']}"
                                     value="#{controller.dataModel}"
                                     singleSelection="#{viewScope.sinSelected}"
                                     multipleSelection="#{viewScope.mulSelected}">
                    <p:ajax event="cellEdit" listener="#{controller.cellEdit}" global="false"
                            update="@widgetVar(resource_dataTable)"/>

                    <p:column headerText="#{msg['blog']['seq']}" field="seq" filterMatchMode="contains" width="80">
                        <p:cellEditor>
                            <f:facet name="output">
                                <h:outputText value="#{element.seq}"/>
                            </f:facet>
                            <f:facet name="input">
                                <p:inputNumber value="#{element.seq}" decimalPlaces="0"/>
                            </f:facet>
                        </p:cellEditor>
                    </p:column>
                    <p:column headerText="#{msg['blog']['name']}" field="name" filterMatchMode="contains"/>
                    <p:column headerText="#{msg['blog']['code']}" field="code" filterMatchMode="contains"/>
                    <p:column headerText="#{msg['framework']['operatedTime']}" sortBy="operatedTime"
                              sortable="true" width="150"
                              sortOrder="desc" sortPriority="1">
                        <h:outputText value="#{element.operatedTime}">
                            <f:convertDateTime type="localDateTime"
                                               pattern="#{msg['format']['localDateTime']}"/>
                        </h:outputText>
                    </p:column>
                    <p:column headerText="#{msg['blog']['remark']}" field="remark" filterable="false" sortable="false"/>
                </framework:dataTable>
            </h:form>
        </div>
    </ui:define>
    <ui:define name="dialog">
        <h:form id="dialogform">
            <framework:dialog id="role" value="#{viewScope.vo}" saveUpdate="@widgetVar(role_dataTable)">

                <framework:label target="name" value="#{msg['blog']['name']}" styleClass="p-col-6">
                    <p:inputText id="name" value="#{viewScope.vo.name}" required="true"/>
                </framework:label>

                <framework:label target="code" value="#{msg['blog']['code']}" styleClass="p-col-6">
                    <p:inputText id="code" value="#{viewScope.vo.code}" required="true"/>
                </framework:label>

                <framework:label target="perms" value="#{msg['blog']['perms']}">
                    <h:outputText rendered="#{fn:length(viewScope.rootTree.children) == 0}"
                                  value="#{msg['framework']['noRecords']}" style="line-height: 30px;"/>
                    <p:tree id="perms" rendered="#{fn:length(viewScope.rootTree.children) != 0}" widgetVar="perms"
                            value="#{viewScope.rootTree}" style="max-height: 250px; overflow: auto"
                            selectionMode="checkbox"
                            var="node" datakey="#{node.id}" selection="#{viewScope.vo.resourceNodes}">
                        <p:treeNode>
                            <h:outputText value="#{node.title}"/>
                        </p:treeNode>
                    </p:tree>
                </framework:label>

                <framework:label target="remark" value="#{msg['blog']['remark']}">
                    <p:inputTextarea id="remark" value="#{viewScope.vo.remark}" autoResize="false"/>
                </framework:label>

            </framework:dialog>
        </h:form>
    </ui:define>
</ui:composition>