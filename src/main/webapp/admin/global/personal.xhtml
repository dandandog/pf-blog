<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                template="/WEB-INF/template.xhtml"
                xmlns:framework="http://java.sun.com/jsf/composite/components">

    <ui:define name="title">Empty Page</ui:define>

    <ui:define name="head">
        <h:outputStylesheet>
            .xxxlarge {
                width: 200px !important;
                height: 200px !important;
                font-size: 28px !important;;
            }

        </h:outputStylesheet>
    </ui:define>

    <ui:define name="viewname">
        <li>global</li>
        <li>/</li>
        <li>personal</li>
    </ui:define>

    <ui:define name="content">
        <div class="card">
            <h:form id="personal_form" prependId="false">

                <p:toolbar id="entityToolbar" styleClass="ui-my-toolbar" style="border: unset;">
                    <f:facet name="left">
                        <p:outputPanel layout="inline">
                            <p:commandButton id="save_btn" widgetVar="save_btn" icon="pi pi-save"
                                             style="margin-right: .5rem"
                                             value="#{msg['framework']['save']}"
                                             action="#{controller.save}"
                                             update="@form"/>
                        </p:outputPanel>
                    </f:facet>

                </p:toolbar>

                #{msg['blog']['personalSetting']}

                <p:outputPanel style="width: 800px;margin: auto">
                    <p:outputPanel class="p-d-flex p-ai-start ">
                        <p:outputPanel layout="block" styleClass="ui-fluid p-formgrid p-grid">
                            <p:divider align="left" type="dashed">
                                <b>#{msg['blog']['personalInfo']}</b>
                            </p:divider>

                            <framework:label value="#{msg['framework']['username']}">
                                <p:inputText value="#{viewScope.user.username}"/>
                            </framework:label>
                            <framework:label value="#{msg['blog']['nickname']}">
                                <p:inputText value="#{viewScope.user.nickname}"/>
                            </framework:label>
                            <framework:label value="#{msg['blog']['homepage']}">
                                <p:inputText value="#{viewScope.user.remark}"/>
                            </framework:label>
                            <framework:label value="#{msg['blog']['email']}">
                                <p:inputText value="#{viewScope.user.email}"/>
                            </framework:label>

                            <p:divider align="left" type="dashed">
                                <b>#{msg['blog']['password']}</b>
                            </p:divider>

                            <framework:label value="#{msg['framework']['inputPassword']}">
                                <p:password id="password1" match="@widgetVar(password2)" feedback="true"
                                            autocomplete="new-password"
                                            promptLabel="#{msg['framework']['promptPassword']}"
                                            weakLabel="#{msg['framework']['weakPassword']}"
                                            goodLabel="#{msg['framework']['goodPassword']}"
                                            strongLabel="#{msg['framework']['strongPassword']}"
                                            value="#{viewScope.user.password}"/>
                            </framework:label>

                            <framework:label value="#{msg['framework']['confirmPassword']}">
                                <p:password id="password2" widgetVar="password2" autocomplete="new-password"
                                            value="#{viewScope.user.password}"/>
                            </framework:label>

                        </p:outputPanel>
                        <p:outputPanel layout="block" styleClass="p-md-4">
                            <p:outputPanel id="avatar_panel" styleClass="p-text-center">
                                <p:avatar rendered="#{empty viewScope.user.avatarUrl}"
                                          label="#{viewScope.user.nickname}"
                                          styleClass="xxxlarge"/>
                                <p:avatar rendered="#{not empty viewScope.user.avatarUrl}"
                                          styleClass="xxxlarge">
                                    <p:graphicImage url="#{viewScope.user.avatarUrl}"/>
                                </p:avatar>
                                <p:commandButton value="#{msg['framwork']['edit']}" action="#{controller.edit}"
                                                 oncomplete="PF('cropper_dialog').show()" style="width: 200px;"
                                                 update="@widgetVar(cropper_dialog)"/>
                            </p:outputPanel>
                        </p:outputPanel>
                    </p:outputPanel>
                </p:outputPanel>
            </h:form>
        </div>
    </ui:define>
    <ui:define name="dialog">
        <h:form id="dialogForm">
            <framework:dialog id="cropper" saveDisabled="false" saveUpdate="@widgetVar(resource_treeTable)">
                <p:fileUpload value="#{viewScope.originalImageFile}" mode="simple" skinSimple="true" auto="true"
                              process="@this" update="@widgetVar(croppedImage)" ajax="true"
                              listener="#{controller.handleFileUpload}"/>

                <p:commandButton value="Crop"
                                 action="#{controller.crop}"
                                 update="@(.cropped)" styleClass="p-my-3"/>
                <div class="p-col-5 p-d-flex p-ai-center p-jc-center">
                    <p:imageCropper widgetVar="croppedImage"
                                    value="#{viewScope.croppedImage}"
                                    id="imageCropper" cache="false"
                                    image="#{controller.image}"
                                    initialCoords="50,50,150,100"
                                    minSize="50,50" maxSize="350,350"/>
                </div>
                <div class="p-col-2">
                    <p:divider layout="vertical">
                        <b>OR</b>
                    </p:divider>
                </div>
                <div class="p-col-5 p-d-flex p-ai-center p-jc-center">
                    <p:graphicImage styleClass="cropped" cache="false" stream="false"
                                    rendered="#{not empty viewScope.croppedImage}"
                                    value="#{viewScope.croppedImage}"/>
                </div>
            </framework:dialog>
        </h:form>
    </ui:define>
</ui:composition>