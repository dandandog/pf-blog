<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
                template="/WEB-INF/templates/admin.xhtml"
                xmlns:framework="http://java.sun.com/jsf/composite/components">
    <ui:define name="title">#{msg['blog']['dictManagement']}</ui:define>
    <ui:define name="head">
        <h:outputStylesheet>
            .ui-chips-container {
                max-height: 200px !important;
                overflow-y: auto !important;
            }
        </h:outputStylesheet>

    </ui:define>
    <ui:define name="viewname">
        <li>#{msg['blog']['set']}</li>
        <li>/</li>
        <li>#{msg['blog']['dictManagement']}</li>
    </ui:define>
    <ui:define name="content">
        <div class="card">
            <h:form id="dict_form" prependId="false">
                <framework:dataTable id="dict" formDialogId="dict"
                                     headText="#{msg['blog']['dictManagement']}"
                                     value="#{viewScope.list}"
                                     singleSelection="#{viewScope.sinSelected}"
                                     multipleSelection="#{viewScope.mulSelected}">
                    <p:ajax event="cellEdit" listener="#{controller.cellEdit}" global="false"
                            update="@widgetVar(dict_dataTable)"/>

                    <p:headerRow field="node.id"
                                 expandable="true">
                        <p:column colspan="7">
                            <p:outputPanel styleClass="p-d-inline-flex p-ai-center p-jc-between">

                                <p:inplace editor="true">
                                    <p:ajax event="save" listener="#{controller.onChangeSeq(element.node)}"
                                            process="@this"/>
                                    <p:inputText size="1" value="#{element.node.seq}"/>
                                </p:inplace>
                                <p:outputPanel layout="inline" style="padding: 0.5rem 0.5rem;line-height: 20px;">
                                    #{element.node.name}-#{element.node.code} :
                                    <h:outputText value="#{element.node.remark}"/>
                                </p:outputPanel>


                                <p:commandButton title="#{msg['framework']['add']}"
                                                 pt:data-tooltip="#{msg['framework']['add']}"
                                                 process="@this"
                                                 update="@widgetVar(dict_dialog)" oncomplete="PF('dict_dialog').show()"
                                                 action="#{controller.add}"
                                                 icon="pi pi-plus"
                                                 styleClass="rounded-button">
                                    <f:setPropertyActionListener value="#{element}" target="#{viewScope.sinSelected}"/>
                                </p:commandButton>
                            </p:outputPanel>
                        </p:column>
                    </p:headerRow>

                    <p:column headerText="#{msg['blog']['seq']}"
                              field="seq" filterMatchMode="equals">
                        <p:cellEditor>
                            <f:facet name="output">
                                <h:outputText value="#{element.seq}"/>
                            </f:facet>
                            <f:facet name="input">
                                <p:inputNumber value="#{element.seq}" styleClass="ui-column-filter"/>
                            </f:facet>
                        </p:cellEditor>
                    </p:column>
                    <p:column headerText="#{msg['blog']['label']}"
                              field="label" filterMatchMode="equals"/>
                    <p:column headerText="#{msg['blog']['code']}"
                              field="code" filterMatchMode="equals"/>
                    <p:column headerText="#{msg['blog']['inputType']}"
                              field="type" filterMatchMode="contains"/>
                    <p:column headerText="#{msg['blog']['remark']}"
                              field="remark" filterMatchMode="contains"/>
                </framework:dataTable>
            </h:form>
        </div>
    </ui:define>

    <ui:define name="dialog">
        <h:form id="dialogform">
            <framework:dialog id="dict" value="#{viewScope.vo}"
                              saveUpdate="@widgetVar(dict_dataTable)">

                <p:divider align="left" type="dashed">
                    <b>#{msg['blog']['dictNode']}</b>
                </p:divider>

                <framework:label target="name" value="#{msg['blog']['name']}" styleClass="p-col-6 node-input">
                    <p:inputText id="name" value="#{viewScope.vo.node.name}" required="true"/>
                </framework:label>
                <framework:label target="code" value="#{msg['blog']['code']}" styleClass="p-col-6  node-input">
                    <p:inputText id="code" value="#{viewScope.vo.node.code}" required="true"/>
                </framework:label>
                <framework:label target="remark" value="#{msg['blog']['remark']}" styleClass="p-col-12 node-input">
                    <p:inputTextarea id="remark" value="#{viewScope.vo.node.remark}" autoResize="false"/>
                </framework:label>

                <p:divider align="left" type="dashed">
                    <b>#{msg['blog']['dictValue']}</b>
                </p:divider>

                <framework:label target="label" value="#{msg['blog']['label']}" indicateRequired="true"
                                 styleClass="p-col-6">
                    <div class="ui-inputgroup">
                        <p:selectBooleanButton id="def" value="#{viewScope.vo.req}"
                                               onLabel="#{msg['blog']['reqYes']}"
                                               offLabel="#{msg['blog']['reqNo']}"
                                               style="width:90px"/>
                        <p:inputText id="label" value="#{viewScope.vo.label}" label="#{msg['blog']['label']}"
                                     required="true"/>
                    </div>
                </framework:label>
                <framework:label target="value" value="#{msg['blog']['code']}" styleClass="p-col-6">
                    <p:inputText id="value" value="#{viewScope.vo.code}"/>
                </framework:label>

                <framework:label target="inputType" value="#{msg['blog']['inputType']}" styleClass="p-col-6">
                    <p:selectOneMenu id="inputType" value="#{viewScope.vo.type}" required="true"
                                     converter="#{inputTypeConverter}">
                        <f:selectItems value="#{viewScope.types}" var="type"
                                       itemLabel="#{msg['inputType'][type.title]}" itemValue="#{type}"/>
                    </p:selectOneMenu>
                </framework:label>

                <framework:label value="#{msg['blog']['value']}" styleClass="p-col-12">
                    <p:chips value="#{viewScope.vo.value}" converter="#{inputItemConverter}" styleClass="value-chips"/>
                </framework:label>

                <framework:label target="valueRemark" value="#{msg['blog']['remark']}">
                    <p:inputTextarea id="valueRemark" value="#{viewScope.vo.remark}"/>
                </framework:label>

            </framework:dialog>
        </h:form>
    </ui:define>
</ui:composition>